# 🙋 오답 노트 2



## 📗 IAM

- Region에 국한되지 않고 사용 가능

- 루트 계정 : 계정을 처음 설정할 때 생성된 계정
- 신규 유저는 생성시 아무런 권한이 없음



### 🌍Neupune

- 빠르고 안정적인 종합 관리형 그래프 데이터 베이스 서비스로, 연결된 데이터 세트를 사용하는 애플리케이션을 쉽게 빌드하고 실행할 수 있다
- 핵심은 특별한 용도의 고성능 그래프 데이터 베이스 앤진이다



# 🌍Security Group

- 하나 이상의 인스턴스에 대한 트래픽을 제어하는 가상 방화벽 역할

- 인스턴스를 시작할 때 하나 이상의 보안 그룹을 지정 가능하다

- 연결된 인스턴스를 오가는 트래픽을 허용하는 각 보안 그룹에 규칙을 추가할 수 있다

- 보안 그룹의 규칙은 언제든지 수정 가능하다

- 새 규칙은 보안 그룹과 연결된 모든 인스턴스에 자동으로 적용된다

- 기본적으로 모든 아웃 바운드 트래픽을 허용한다

- 보안 그룹 규칙은 항상 허용된다 / 액세스를 거부하는 규칙을 만들 수 없다

- ## NACL

  - 우선 순위 값이 존재하며 가장 작은 값이 가장 높은  우선순위를 가지고 우선순위부터 적용됨
  - 서브넷의 가상 방화벽이기 때문에 서브넷에 속한 모든 인스턴스가 영향을 받음

# 📗 S3

- 생명 주기
  - 객체를 일정 시간 후에 다른 타입으로 변경 (클래스 변경)
  - 버전에 대한 변경
  - Standard - IA와 One Zone IA는 보관 후 30일 이후 이전 가능

-  Bucket
  - 리전을 지정하여 버킷을 생성해야 한다

### 🌍Security

- KMS
  -  암호화를 활성하기 위해서 사용자의 이름과 암호를 지원하지 않음

#### < 서버 측 : S3에 저장될 때의 암호화>

- SSE-KMS
  - KMS는 안전하고 가용성이 높은 하드웨어와 소프트웨어를 결합하여 클라우드에 맞게 확장된 **키 관리 시스템**을 제공하는 서비스
- SSE-S3
  - S3 관리형 키와 함께 서버 측 암호화를 사용하면 각 개체가 고유한 키로 암호화됨, S3가 암호화의 주체가 됨
- SSE-C
  - 고객 제공 키를 사용한 서버 측 암호화를 사용하면 암호화 키를 관리하고 S3는 디스크에 쓸 때 암호화를 관리하고 객체에 액세스 할 때 암호를 해독한다

#### < 클라이언트 측 : 클라이언트가 S3에 전송될 때의 암호화>

- 클라이언트 측 암호화
  - 클라이언트 측 암호화는 데이터를 S3로 보내기 전에 암호화하는 행위

## 🌍Direct Connect 

- 온프레미스에서 aws 전용 네트워크 연결을 쉽게 설정할 수 있는 클라우드 솔루션
- 연결이 비공개 이므로 뛰어난 성능과 보안을 보장함
- 백업 용으로는 실패할 위험이 있음

- ## Site to Site VPN

  - 온 프레미스 네트워크 또는 지사 사이트를 VPC에 안전하게 연결할 수 있다
  - VPN 연결은 몇 분만에 구성 할 수 있으며 인터넷 기반 연결의 고유한 가변성을 허용한다

# private link

퍼블릭ip를 사용하지 않고 트래픽이 인터넷에 연결되지 않아도 vpc에서 전용으로 aws 리소스를 사용 가능하다

 - 온프레미스나 aws 리소스와 vpc 간의 비공개 네트워크
- 트래픽이  인터넷에 노출 되지 않는 것을 보장함
- 여러 계정과 VPC에 걸쳐 손쉽게  서비스에 연결
- vpc 피어링보다 성능 조음

# 🌍Cognito

-  웹 및 모바일앱에 대한 인증, 권한 및 사용자 관리

  직접  로그인히거니  구글 떠는  애플과같은 타사를 통해 로그인 가능

Amazon Cognito의 두 가지 주요 구성 요소는 사용자 풀과 자격 증명 풀입니다. 사용자 풀은 앱 사용자의 가입 및 로그인 옵션을 제공하는 사용자 디렉터리입니다. 자격 증명 풀을 통해 기타 AWS 서비스에 대한 사용자 액세스 권한을 부여할 수 있습니다. 자격 증명 풀과 사용자 풀을 별도로 또는 함께 사용할 수 있습니다.



# 📗Auto Scaling 

- 예약된 일정 : 수요 변화가 예측 가능한 경우
- 조정 정책
  - 대상 추적 정책 : ASG의 지표 평균값(CPU 사용률, 네트워크 입/출력, 로드밸런서 요청의 수 등)을 목표로 인스턴스 수를 조절
  - 단순 조정 정책 : 지표의 임계치에 도달할 경우, 사용자가 정한 인스턴스 수를 늘리거나 감소시키는 정책
  - 단계 조정 정책 : 단순 조정 정책과 기본은 같지만, 지표 값에 따라 증감 수를 다르게 줄 수 있음

- ELB를 사용하는 경우 : ELB가 손상된 인스턴스를 트래픽 요청 대상에서 분리시킨 후, Auto Scaling이 이를 새로운 인스턴스로 교체함

- 시작 구성 

  - Auto Scaling에서 새로운 인스턴스를 시작할 때 기반이 되는 구성

  - AMI, 인스턴스 유형, 보안그룹 , 스토리지 등 EC2 생성할 때와 마찬가지로 옵션줄 수 있음

  - 시작 구성은 한번 생성 시 수정이 불가하며 복사와 삭제만 가능

  - 변경을 위해서는 기존의 시작 구성을 새로운 시작 구성을 만드는 재료로 사용해야함

    

# 📗 ELB

- 외부/내부 트래픽은 ELB의 DNS 주소를 목적지로 하여 들어오며 이 트래픽을 받은 ELB는 가용영역에 등록된 EC2로 전달
- 보안 그룹 적용
- 대상 그룹 
  - ELB에 등록된 EC2 인스턴스들의 그룹
- 리스너 하나당 요청을 받아들이는 포트를 하나씩 지정함
  - ALB : HTTP(80)/HTTPS 을 리스너가 중점으로 다룸
- ALB 
  - X-forward-for 를 지원하여 ec2로 하여금 클라이언트의 IP를 확인할 수 있도록 한다
  - 공인 IP가 유동적으로 바뀜
- NLB
  - 리스너를 TCP, UDP로 설정 가능
  - 공인 IP가 고정적임

### 🌍 Internet Gateway

- 인터넷 게이트웨이를 생성한 후, '0.0.0.0/0'에 대하여 라우팅 테이블을 인터넷 게이트웨이로 잡아주면 사용가능
- 인터넷 게이트웨이가 있다 하더라도, **VPC 내 리소스가 공인 IP**를 가지고 있지 않다면 인터넷 사용 불가능
- 또한 위의 설정을 모두 했음에도 인터넷이 제대로 되지 않는다면, 보안 그룹과 NACL을 확인해야함



# 📗 VPC

### 🌍 서브넷

- 하나의 서브넷은 하나의 라우팅 테이블과 하나의 NACL을 할당받음
- CIDR (4개의 IP 주소와 마지막 IP 주소는 예약 주소로 사용자가 사용할 수 없음)
  - EX. 172.16.1.0/24 (총 32 중에 24는 고정)
  -  172.16.1.0
  -  172.16.1.1
  -  172.16.1.3
  -  172.16.1.255

### 🌍 ENI

- 가상 네트워크 인터페이스
- 기본적으로 vpc 내 리소스들은 ENI와 사설 IP를 할당받음
- 선택적으로 공인 IP를 받음
- 퍼블릭 서브넷의 경우, 리소스 생성시 자동으로 공인 IP를 할당함

### 🌍 NAT Gateway

- VPC 내부 리소스가 NAT Gateway를 인터넷을 통해서 접속할 수 있지만, 외부에서 NAT Gateway를 통해서 vpc 내부로 들어올 수는 없다
- 퍼블릭 서브넷에 NAT Gateway를 생성한 후, private subnet의 라우팅 테이블에 '0.0.0.0/0'에 대하여 라우팅을 NAT Gateway를 잡아주면 사용이 가능하다

### 🌍 NAT Instance

- Private Subnet의 라우팅 테이블에 '0.0.0.0/0'에 대하여 NAT instance를 연결한 후, ScrDestCheck 속성을 비활성화함

- 인스턴스 이기 때문에 보안그룹의 설정을 적용받으므로 트래픽을 제어할 수 있음

  #### 📌 NAT Gateway vs  NAT Instance

- NAT Gateway는 AWS에서 관리해주기 때문에 유지보수할 필요가 없으나 NAT Instance는 사용자가 직접 관리해야한다
- NAT Instance는 인스턴스이기 때문에 장애가 발생할 가능성이 있어서 스크립트로 인스턴스간 Failover를 신경써야함
- 둘 다 NACL를 통해 트래픽 제어 가능



## 📗 RDS



- #### Multi-AZ 

  - 예비 복제본이기 때문에 읽기 및 쓰기 작업을 수행할 수 없음
  - 단일 AZ에 비해 쓰기 및 저장 지연 시간이 길어질 수 있다 (동기화로 인해서)

  - DB 인스턴스에 문제가 발생하면 자동으로 다른 AZ의 예비 복제본으로 전환한다
  - 전환되는 상황
    - AZ 중단
    - 기본 DB 인스턴스 오류
    - DB 인스턴스 서버 유형 변경
    - 기본 DB 인스턴스 OS에서 소프트웨어 패치 실시
    - 장애 조치 재부팅 실시

- #### Read Replica

  - 읽기 작업만 담당
  - DB 인스턴스의 스냅샷을 캡쳐한 후 이를 기반으로 RR 생성
  - 데이터를 비동기 복제 방식을 통해 업데이트 한다
  - 다른 리전에도 사용 가능
  - 리전당 최대 5개 가능
  - RR도 독립된 인스턴스로 승격 가능

### 📗 EBS

- EBS 볼륨 유형
  - 범용 SSD (gp2) : 시스템 부트 사용 가능, 대부분의 워크로드에서 사용
  - 프로비저닝된 IOPS SSD (io1) : 지속적인 IOPS 성능이나 16000 이상의 IOPS 처리량을 원하는 경우(DB 워크로드)
  - 콜드 HDD(sc1) : 자주 액세스 하지 않는 대용량 데이터, 스토리지 비용이 낮아야하는 경우
  - 처리량 최적화된 HDD (st1) : 처리량을 기준으로 하며 자주 액세스 하는 워크로드에 적합한 저비용 HDD 볼륨, 빅데이터나 데이터웨어하우스에 사용
- 스냅샷
  - 스냅샷을 이용하여 EBS 볼륨의 데이터를 S3에 저장할 수 있다
  - 암호화된 볼륨의 스냅샷은 자동으로 암호화됨
  - 암호화된 스냅샷에서 생성되는 볼륨은 자동으로 암호화됨
  - 암호화되지 않은 EBS에서 암호화된 스냅샷은 생성할 수 없음

### 📗 EC2

- 재부팅의 경우 EBS 기반 EC2와 인스턴스 스토어 기반 EC2 모두 사용가능하나 중지는 EBS 기반 EC2만 사용 가능하다
- 배치 그룹
  - 클러스터 : 인스턴스를 AZ 내에서 근접하게 배치함, 결합된 노드간 지연시간이 낮음
  - 파티션 :  인스턴스가 담긴 그룹을 논리 세그먼트로 나누어 각 파티션에 배치함 
  - 분산 : 파티션이 논리 세그먼트로 분리된 인스턴스 그룹인 것과 달리 분산은 '인스턴스' 개체 하나가 자체 랙에 분산 배치됨
- Elastic IP
  - EC2에 설정되는 네트워크 인터페이스의 공인 IP
  - Elastic IP를 사용하면 EC2로 하여금 중지 되었다가 다시 시작하더라도 고정된 공인 IP를 사용하게 할 수 있음
